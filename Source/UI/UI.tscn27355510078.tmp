[gd_scene load_steps=13 format=3 uid="uid://d4agehp3labnq"]

[ext_resource type="PackedScene" uid="uid://ch40afra268ra" path="res://Source/UI/EscMenu.tscn" id="1_lgolh"]

[sub_resource type="LabelSettings" id="LabelSettings_xb563"]

[sub_resource type="GDScript" id="GDScript_7dm0k"]
script/source = "extends Label


func _process(delta) -> void:
	if Global.session.local_controller.hovered_object:
		text = Global.session.local_controller.hovered_object.name
	else:
		text = ''
		#text = '(%+d,%+d)' % [Global.local_controller.mouse_coords.x, Global.local_controller.mouse_coords.y]
"

[sub_resource type="GDScript" id="GDScript_xb563"]
script/source = "extends Label


func _process(delta) -> void:
	text = Global.session.game.current_time
"

[sub_resource type="GDScript" id="GDScript_fyqef"]
script/source = "extends Label


func _process(delta) -> void:
	text = \"×\" + str(Global.session.game.time_scale)
"

[sub_resource type="GDScript" id="GDScript_m6e0p"]
script/source = "extends Label


func _process(delta) -> void:
	visible = Global.session.game.pause
"

[sub_resource type="GDScript" id="GDScript_1bvp3"]
script/source = "extends HBoxContainer


var zoom_factor: float = 1000


func _process(delta) -> void:
	if !Global.session.local_controller.cam:
		return
	if Global.session.local_controller.cam.zoom.x > 10:
		$Level.text = \"10 m \"
		zoom_factor = 10
	elif Global.session.local_controller.cam.zoom.x > 1:
		$Level.text = \"100 m \"
		zoom_factor = 100
	elif Global.session.local_controller.cam.zoom.x > 0.1:
		$Level.text = \"1 km \"
		zoom_factor = 1000
	elif Global.session.local_controller.cam.zoom.x > 0.01:
		$Level.text = \"10 km \"
		zoom_factor = 10000
	elif Global.session.local_controller.cam.zoom.x > 0.001:
		$Level.text = \"100 km \"
		zoom_factor = 100000
	else:
		$Level.text = \"1000 km \"
		zoom_factor = 1000000
	$ColorRect.custom_minimum_size.x = zoom_factor * Global.session.local_controller.cam.zoom.x
"

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_wusub"]
bg_color = Color(0.25098, 0.25098, 0.25098, 1)

[sub_resource type="GDScript" id="GDScript_wusub"]
script/source = "extends RichTextLabel


func _add_message(content: String) -> void:
	newline()
	append_text(content)
"

[sub_resource type="GDScript" id="GDScript_b3bc3"]
script/source = "extends LineEdit

func _unhandled_input(event):
	if event.is_action_pressed(\"message\"):
		focus_mode = Control.FOCUS_ALL
		edit()


func _on_text_submitted(new_text):
	clear()
	focus_mode = Control.FOCUS_NONE


func _on_editing_toggled(toggled_on):
	if !toggled_on:
		focus_mode = Control.FOCUS_NONE
"

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_b3bc3"]
bg_color = Color(0.25098, 0.25098, 0.25098, 1)

[sub_resource type="GDScript" id="GDScript_3b2b5"]
script/source = "extends VBoxContainer


func clear() -> void:
	for child in get_children():
		remove_child(child)
		child.queue_free()


func update() -> void:
	for unit in Global.session.local_controller.player.units:
		var new_label = Label.new()
		label.text = unit.name
		add_child(new_label)
"

[node name="UI" type="CanvasLayer"]

[node name="HBoxContainer" type="HBoxContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/separation = 0

[node name="VBoxContainer" type="VSplitContainer" parent="HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
mouse_filter = 2
theme_override_constants/separation = 0
dragging_enabled = false
dragger_visibility = 2

[node name="Overlay" type="Control" parent="HBoxContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
mouse_filter = 2

[node name="CursorTarget" type="Label" parent="HBoxContainer/VBoxContainer/Overlay"]
layout_mode = 2
offset_right = 40.0
offset_bottom = 23.0
label_settings = SubResource("LabelSettings_xb563")
script = SubResource("GDScript_7dm0k")

[node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer/VBoxContainer/Overlay"]
layout_mode = 2
anchor_top = 1.0
anchor_bottom = 1.0
offset_top = -50.0
offset_right = 1042.0
alignment = 2

[node name="Time" type="HBoxContainer" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 0

[node name="WorldTime" type="Label" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer/Time"]
layout_mode = 2
text = "00:00:00"
script = SubResource("GDScript_xb563")

[node name="TimeScale" type="Label" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer/Time"]
layout_mode = 2
text = "×1.0"
script = SubResource("GDScript_fyqef")

[node name="Pause" type="Label" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer/Time"]
layout_mode = 2
text = "PAUSED"
script = SubResource("GDScript_m6e0p")

[node name="Scale" type="HBoxContainer" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer"]
layout_mode = 2
mouse_filter = 2
script = SubResource("GDScript_1bvp3")

[node name="Level" type="Label" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer/Scale"]
layout_mode = 2
text = "1 km"

[node name="ColorRect" type="ColorRect" parent="HBoxContainer/VBoxContainer/Overlay/VBoxContainer/Scale"]
custom_minimum_size = Vector2(1000, 4)
layout_mode = 2
size_flags_vertical = 4
mouse_filter = 2

[node name="BottomBar" type="PanelContainer" parent="HBoxContainer/VBoxContainer"]
custom_minimum_size = Vector2(0, 300)
layout_mode = 2
mouse_force_pass_scroll_events = false
theme_override_styles/panel = SubResource("StyleBoxFlat_wusub")

[node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer/VBoxContainer/BottomBar"]
layout_mode = 2

[node name="Messages" type="RichTextLabel" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
bbcode_enabled = true
scroll_following = true
meta_underlined = false
script = SubResource("GDScript_wusub")

[node name="LineEdit" type="LineEdit" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer"]
layout_mode = 2
focus_mode = 0
caret_blink = true
caret_blink_interval = 0.5
script = SubResource("GDScript_b3bc3")

[node name="HBoxContainer" type="HBoxContainer" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer"]
layout_mode = 2

[node name="Filter1" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "Filter"

[node name="Filter2" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "buttons"

[node name="Filter3" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "for"

[node name="Filter4" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "message"

[node name="Filter5" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "box
"

[node name="Filter6" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "can"

[node name="Filter7" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "go
"

[node name="Filter8" type="Button" parent="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
focus_mode = 0
text = "here"

[node name="SideBar" type="PanelContainer" parent="HBoxContainer"]
custom_minimum_size = Vector2(360, 0)
layout_mode = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_b3bc3")

[node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer/SideBar"]
layout_mode = 2

[node name="Label" type="Label" parent="HBoxContainer/SideBar/VBoxContainer"]
custom_minimum_size = Vector2(360, 300)
layout_mode = 2
text = "Here
Be
Minimap"
horizontal_alignment = 1
vertical_alignment = 1
autowrap_mode = 2

[node name="TabContainer" type="TabContainer" parent="HBoxContainer/SideBar/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
tab_alignment = 1
current_tab = 0
tab_focus_mode = 0

[node name="Units" type="VBoxContainer" parent="HBoxContainer/SideBar/VBoxContainer/TabContainer"]
layout_mode = 2
script = SubResource("GDScript_3b2b5")
metadata/_tab_index = 0

[node name="Menu" parent="." instance=ExtResource("1_lgolh")]

[connection signal="editing_toggled" from="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/LineEdit" to="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/LineEdit" method="_on_editing_toggled"]
[connection signal="text_submitted" from="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/LineEdit" to="HBoxContainer/VBoxContainer/BottomBar/VBoxContainer/LineEdit" method="_on_text_submitted"]
